<!DOCTYPE html>
<html>
  <head>
	
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" integrity="sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX" crossorigin="anonymous">
	

	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==" crossorigin="anonymous"></script>
	

  </head>
  
  <body>
  	<div ng-app="Mtaas"  data-ng-controller="Mtaas">

	

        	
<!-- -#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#- -->
<!-- -#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#- -->
<!-- -#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#- -->
        	<!-- Side Bar Processing -->
        	<!-- Sign In Form -->
			<div class="col-md-4 ng-show sidebar" ng-hide="main">
         	<form name="mainform" novalidate>
         	<div class="row radio">
  				<input type="radio" ng-model="signon" name="signon" value="ad_signon" ng-change="mainr()">Sign In as Adoptor
			</div>
			
  			<div class="row radio">	  				
				<input type="radio" ng-model="signon" name="signon" value="sh_signon" ng-change="mainr()">Sign In as Shelter
			</div>
  			
			<div class="row ">	  			
				<input type="email" name="email" ng-model="email" maxlength="30" placeholder="Email" ng-change="ismaindisabled()" required>
				<span style="color:green" class="glyphicon glyphicon-ok" ng-show="mainform.email.$dirty && mainform.email.$valid"></span>
				<span style="color:red" ng-show="mainform.email.$dirty && mainform.email.$invalid">
				<span ng-show="mainform.email.$error.required">
				<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
			  	<span class="sr-only">Error:</span>
			  	Email required
			 	</span>
				<span ng-show="mainform.email.$error.email"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
			  	<span class="sr-only">Error:</span>
			  	Enter a valid email address
			  	</span>
				</span>
			</div>
     		
     		<div class="row">			
 				<input type="password" name="password" ng-model="password" maxlength="15" placeholder="Password" ng-change="ismaindisabled()" required>
				<span style="color:red" ng-show="mainform.password.$dirty && mainform.password.$invalid">
				<span ng-show="mainform.password.$error.required">
				<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
				<span class="sr-only">Error:</span>
				Password required
				</span>
				</span>
				</span>
           	</div>
		   	
		   	<div class="row">			
           		<input class="btn btn-primary" name="SignIn" type="submit" ng-click="signin()" ng-disabled="mainsub">
         	</div>
         	
         	<div class="row">
         		<p><a role="button"  ng-model="selected" href="" ng-click="signup()">Register for New User/New Shelter!</a></p>
         	</div>
         	</form>
         	</div>

<!-- -#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#- -->
<!-- -#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#- -->
<!-- -#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#--#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#- -->
                <!-- Sign Up form for Adoptor -->
	           	<div  ng-show=false>         				
      				<form name="ad_up_form" novalidate>	
      					<input type="email" name="ad_email" ng-model="ad_email" maxlength="30" placeholder="Email" ng-change="isadupdisabled()" required>
						<span style="color:red" ng-show="ad_up_form.ad_email.$dirty && ad_up_form.ad_email.$invalid">
							<span ng-show="ad_up_form.ad_email.$error.required">Email is required.</span>
							<span ng-show="ad_up_form.ad_email.$error.email">Invalid email address.</span>
						</span>
      					
      					<input type="password" name="ad_password" ng-model="ad_password" maxlength="15" placeholder="Password" ng-change="isadupdisabled()" required>
						<span style="color:red" ng-show="ad_up_form.ad_password.$dirty && ad_up_form.ad_password.$invalid">
							<span ng-show="ad_up_form.ad_password.$error.required">Password is required.</span>
						</span>
						
						<input type="fname" name="ad_fname" ng-model="ad_fname" maxlength="30" placeholder="First Name" ng-change="isadupdisabled()" required>
						<span style="color:red" ng-show="ad_up_form.ad_fname.$dirty && ad_up_form.ad_fname.$invalid">
							<span ng-show="ad_up_form.ad_fname.$error.required">First Name is required.</span>
						</span>
						
						<input type="lname" name="ad_lname" ng-model="ad_lname" maxlength="30" placeholder="Last Name" ng-change="isadupdisabled()" required>
						<span style="color:red" ng-show="ad_up_form.ad_lname.$dirty && ad_up_form.ad_lname.$invalid">
							<span ng-show="ad_up_form.ad_lname.$error.required">Last Name is required.</span>
						</span>
						
						<input type="number" name="ad_contact" ng-model="ad_contact" maxlength="10" placeholder="Contact" ng-change="isadupdisabled()" required>
						<span style="color:red" ng-show="ad_up_form.ad_contact.$dirty && ad_up_form.ad_contact.$invalid">
							<span ng-show="ad_up_form.ad_contact.$error.required">Contact is required.</span>
						</span>
						
						<input type="text" name="ad_address" ng-model="ad_address" maxlength="45" placeholder="Address" ng-change="isadupdisabled()" required>
						<span style="color:red" ng-show="ad_up_form.ad_address.$dirty && ad_up_form.ad_address.$invalid">
							<span ng-show="ad_up_form.ad_address.$error.required">Address is required.</span>
						</span>
                    
                     	<input type="submit" ng-click="ad_signup()" ng-disabled="adupsub">
						</form>
					</div>

		        

    </div>
    </body>

<script>

		var app = angular.module('Mtaas', []);
		
		app.controller('Mtaas', ['$scope','$http','$window',function ($scope,$http,$window) 
	{
			$scope.mainsub = true;
			$scope.adupsub = true;
			$scope.shupsub = true;
			$scope.ptinsrt = true;
			$scope.ptsearcch = true;
			$scope.searchpetshow = false;
			$scope.resaftintr = true;
			$scope.moredetshow=false;
	
			$http({
      	  		method: 'GET',
      	 		url: '/checkLogin'
        	 }).
        then(function(response)
        	{
        	  	if (response.data.status == 200)
					{	
        	  			if(response.data.type === 'AD')
        	  				{	
	        	 				$scope.username=response.data.name;
	        	 				$scope.ademailid=response.data.mail;
	        	 				$scope.main=true;
	        	 				$scope.adwelcome=true;
        	  				}
        	  			else
        	  				{	
        	  					/* $scope.username=response.data.name;
        	  					$scope.sh_ret_email=response.data.mail;
        	  					alert($scope.sh_ret_email);
        	  					$scope.main=true;
        	 					$scope.shwelcome=true; */	
        	 					$window.location.href = '/showshelter';
        	  				}
					}
        	  	
        	 });

			
			$http({
				
      	  		method: 'GET',
      	 		url: '/petdetails'
        	 }).
        then(function(response)
        	{
        		//alert(response.data.status);
        		//alert(response.data.l);
        		//alert(response.data.result);
        	  	if (response.data.status == 200)
					{
        	  		$scope.details1=angular.fromJson(response.data.result);
        	  		var details=angular.fromJson(response.data.result);
        	  			for (var i=0; i<response.data.l; i++){
        	  				$scope.id=details[i]["p_id"];
        	  				//alert(details[i]["p_id"]);
	        	 	 	} 
					}
        	  	
        	 });
			
			
			
			$scope.ismaindisabled = function()
			{
				if($scope.mainform.email.$dirty && $scope.mainform.email.$valid)
					{
					if($scope.mainform.password.$dirty && $scope.mainform.password.$valid)
						{
						if($scope.mainrd === true)
							{
							$scope.mainsub = false;
							}
						}
					else
						{
						$scope.mainsub = true;
						}
					}
			}
			
			$scope.isadupdisabled = function()
			{
				if($scope.ad_up_form.ad_email.$dirty && $scope.ad_up_form.ad_email.$valid)
					{
					if($scope.ad_up_form.ad_password.$dirty && $scope.ad_up_form.ad_password.$valid)
						{
						if($scope.ad_up_form.ad_fname.$dirty && $scope.ad_up_form.ad_fname.$valid)
							{
							if($scope.ad_up_form.ad_lname.$dirty && $scope.ad_up_form.ad_lname.$valid)
								{
								if($scope.ad_up_form.ad_contact.$dirty && $scope.ad_up_form.ad_contact.$valid)
									{
									if($scope.ad_up_form.ad_address.$dirty && $scope.ad_up_form.ad_address.$valid)
										{
										$scope.adupsub = false;
										}
									}
								}
							}
						}
					else
						{
						$scope.adupsub = true;
						}
					}
			}
			
			$scope.isshupdisabled = function()
			{
				if($scope.sh_up_form.sh_email.$dirty && $scope.sh_up_form.sh_email.$valid)
					{
					if($scope.sh_up_form.sh_password.$dirty && $scope.sh_up_form.sh_password.$valid)
						{
						if($scope.sh_up_form.sh_name.$dirty && $scope.sh_up_form.sh_name.$valid)
							{
							if($scope.sh_up_form.sh_contact.$dirty && $scope.sh_up_form.sh_contact.$valid)
								{
								if($scope.sh_up_form.sh_address.$dirty && $scope.sh_up_form.sh_address.$valid)
									{
									$scope.shupsub = false;
									}
								}
							}
						}
					else
						{
						$scope.shupsub = true;
						}
					}
			}
			
			$scope.petsrdisabled = function()
			{
				if($scope.pet_search_form.sr_type.$dirty && $scope.pet_search_form.sr_type.$valid)
					{
						$scope.ptsearcch = false;
					}
				if($scope.pet_search_form.sr_color.$dirty && $scope.pet_search_form.sr_color.$valid)
					{
						$scope.ptsearcch = false;
					}
				if($scope.pet_search_form.sr_breed.$dirty && $scope.pet_search_form.sr_breed.$valid)
					{
						$scope.ptsearcch = false;
					}
				if($scope.pet_search_form.sr_gender.$dirty && $scope.pet_search_form.sr_gender.$valid)
					{
						$scope.ptsearcch = false;
					}
			}

			$scope.mainr = function (){
				$scope.mainrd = true;  
				if($scope.mainform.email.$dirty && $scope.mainform.email.$valid)
				{
				if($scope.mainform.password.$dirty && $scope.mainform.password.$valid)
					{
					if($scope.mainrd === true)
						{
						//alert
						$scope.mainsub = false;
						}
					}
				else
					{
					$scope.mainsub = true;
					}
				}
			}
			
			$scope.ad_up = function (){
				$scope.ad_sgnup = true;  
				$scope.sh_sgnup = false;
			}
			
			$scope.ad_in = function (){
				$scope.ad_sgnin = true;  
			}
			
			$scope.sh_up = function (){
				$scope.sh_sgnup = true;  
				$scope.ad_sgnup = false;
			}
			
			$scope.sh_in = function (){
				$scope.sh_sgnin = true;  
			}
			
			$scope.signup = function (){
					$scope.landup = true;
					$scope.main = true;	
			}
			
			$scope.pt_details = function (){
				$scope.pt_detail = true;  
			}
			
			$scope.new_pet = function (){
				$scope.shwelcome = false;
				$scope.pt_detail = true;  
				
			}
			
			$scope.moredet = function (id1){
				alert("In more details function");
	  			//alert(id1["p_id"]);
	  			var id2 = id1["p_id"];
	  			$http({
			      	  method: 'POST',
			      	  url: '/morepetdet',
			      	  data: {"id2":id2}
			        }).
			          then(function(response) {
			        	  if (response.data.status == 200)
							{
			        		  $scope.initpet="true"; 
			        		  $scope.searchpetshow=false;
			        	//	  $scope.searchpethide="true";
			        	//	  
			        		  $scope.moredetshow=true;
			        		  
			        		  alert("$scope.initpet "+$scope.initpet);
			        		  alert("$scope.searchpethide "+$scope.searchpethide);
			        		  alert("$scope.moredetshow "+$scope.moredetshow);
			        		  alert("$scope.searchpetshow "+$scope.searchpetshow);
			        		  alert("$scope.moredethide "+$scope.moredethide);
			        		  
			        		  
			        		  $scope.details1=angular.fromJson(response.data.result);
		        	  		var details=angular.fromJson(response.data.result);
		        	  			for (var i=0; i<response.data.l; i++){
		        	  				$scope.id=details[i]["p_id"];
		        	  				alert(details[i]["p_id"]);
		        	  				//alert(details[i]["p_id"]);
			        	 	 	}
							}
								
			          }); 
			}
			
			$scope.ad_signup = function (){
				var ad_email=$scope.ad_email;
				var ad_password=$scope.ad_password;
				var ad_fname=$scope.ad_fname;
				var ad_lname=$scope.ad_lname;
				var ad_contact=$scope.ad_contact;
				var ad_address=$scope.ad_address;
				$http({
			      	  method: 'POST',
			      	 url: '/ad_signup',
			      	 data: {"ad_email":ad_email,"ad_password":ad_password,"ad_fname":ad_fname,"ad_lname":ad_lname,"ad_contact":ad_contact,"ad_address":ad_address}
			        }).
			          then(function(response) {
			        	  $window.location.href = '/success';
			          }); 
			}
			
			$scope.signin = function (){
				var email=$scope.email;
				var password=$scope.password;
			//	alert($scope.password);
			//	if ($scope.signon === "ad_signon")
				//	{
						$http({
				      	  		method: 'POST',
				      	 		url: '/tr_signin',
				      	 		data: {"email":email,"password":password}
				        	 }).
				        then(function(response)
				        	{
				        	//alert(email);
				        	/*  	if (response.data.status == 200)
									{
					        	 		$scope.username=response.data.name;
					        	 		$scope.ademailid=response.data.email;
					        	 		$scope.main=true;
					        	 		$scope.adwelcome=true;
					        	 		$scope.searchpetshow=false;
									}
				        	  	else
				        			{*/
					        			alert("Invalid Usernme or Password"); 
				   //     		  	}
				        	 }); 
				      }
			        	
			/*	if ($scope.signon === "sh_signon")
				{
					$http({
			      	  		method: 'POST',
			      	 		url: '/sh_signin',
			      	 		data: {"email":email,"password":password}
			        	 }).
			        then(function(response)
			        	{
			        	 
		        	  	  if (response.data.status == 200)
							{
			        	 		$scope.username=response.data.name;
			        	// 		alert(response.data.email);
			        	 		$scope.sh_ret_email=response.data.email;
			        	 		$scope.main=true;
			        	 		$scope.shwelcome=true; 
		        	  		    $window.location.href = '/showshelter';
							}
		        	  	else
		        			{
			        			alert("Invalid Usernme or Password"); 
		        		  	} 
			        	 }); 
			      }*/

			         
			}
			
			$scope.sh_signup = function (){
				var sh_email=$scope.sh_email;
				var sh_password=$scope.sh_password;
				var sh_name=$scope.sh_name;
				var sh_contact=$scope.sh_contact;
				var sh_address=$scope.sh_address;
				$http({
			      	  method: 'POST',
			      	 url: '/sh_signup',
			      	 data: {"sh_email":sh_email,"sh_password":sh_password,"sh_name":sh_name,"sh_contact":sh_contact,"sh_address":sh_address}
			        }).
			          then(function(response) {
			        	  $window.location.href = '/success';
			          }); 
			}
			
			$scope.adpetsearch = function (){
				alert("In pet search function");
				var sr_type=$scope.sr_type;
				var sr_color=$scope.sr_color;
				var sr_breed=$scope.sr_breed;
				var sr_gender=$scope.sr_gender;
		//		alert("var sr_type=$scope.sr_type;"+$scope.sr_type);
				$http({
			      	  method: 'POST',
			      	  url: '/petsearch',
			      	  data: {"sr_type":sr_type,"sr_color":sr_color,"sr_breed":sr_breed,"sr_gender":sr_gender}
			        }).
			          then(function(response) {
			        	  if (response.data.status == 200)
							{
			        		  	
			        		  	$scope.initpet=true;
			        		  	$scope.searchpetshow=true;
			        		  	$scope.moredetshow=false;
			        		//  	$scope.digest();
			        	  		$scope.details1=angular.fromJson(response.data.result);
			        	  		var details=angular.fromJson(response.data.result);
			     //   	  		alert("details"+details);	
			        	  			for (var i=0; i<response.data.l; i++){
			        	  				$scope.id=details[i]["p_id"];
			        	  				//alert(details[i]["p_id"]);
				        	 	 	} 
								}
			          }); 
			}
			
$scope.interest = function (id1){
				
		//		alert("sdfnkjsdfksdkfnsdkl");
	  	//		alert(id1["p_id"]);
	  			var id2 = id1["p_id"];
	  			var ademail2intrt = $scope.ademailid;
	  			alert(ademail2intrt);
	  			$http({
			      	  method: 'POST',
			      	  url: '/putinterest',
			      	  data: {"id2":id2,"ademail2intrt":ademail2intrt}
			        }).
			          then(function(response) {
			        	  if (response.data.status == 200)
							{
			        		  	
			        		  $scope.resaftintr = false;
							}
								
			          }); 
			}
			
			
	
	
}]);
</script>

  
</html>